# 注册和管理应用

EnOS平台支持应用开发者入驻平台注册应用、删除应用、购买应用、管理应用的使用者及其权限。其中，菜单管理和权限管理，主要面向应用Portal开发者。

## 注册应用

注册应用可获得服务账号（Service Account），服务账号的`AccessKey` 和 `SecretKey` 是调用EnOS API进行应用开发的前提。注册应用的步骤如下：

1. 登录EnOS控制台，选择 **应用注册** ，点击 **创建应用**。 

2. 在创建应用窗口中输入以下字段：

   .. csv-table::
      :widths: auto

      "字段", "说明"
      "应用名称", "必填字段，不超过100个字符。国际化名称为选填项。若未填写，则会以当前语言版本内容填充国际化字段"
      "应用地址", "选填字段，字符串类型，长度不超过2000个字符"
      "应用分类", "应用所属的行业或领域"
      "应用类型", "必填字段，可选Web（网页端）或Mobile（移动端）"
      "应用图标", "支持200*200px，大小不超过50KB，jpg或png格式"
      "详细描述", "中英文都不超过1000字符。国际化字段为选填项。若未填写，则以当前语言版本内容填充国际化字段"

3. 点击**确认**，完成应用创建。

应用注册完成之后，它会被显示在 **组织应用** 标签下。点击应用名称，打开 **应用详情** 页面，查看应用的 `AccessKey` 和 `SecretKey` 等基本信息。如下图所示：

.. image:: media/app_details.png
   :width: 500px

## 管理应用菜单

一个应用可以有许多功能菜单，购买应用的一方未必购买了所有功能菜单。应用管理者可以管理应用菜单以新建菜单，并指定已购买了应用的各组织用户能够使用该应用的哪些菜单。EnOS目前支持为一个应用设置2个层级的菜单。

### 新建菜单

配置应用菜单是授权购买应用方使用特定菜单的前提。配置应用菜单的步骤如下：

1. 选择 **应用注册**， 点击应用名进入 **应用详情** 页面。

2. 选择 **菜单管理** 标签页，点击 **新建菜单**，在弹窗中输入以下字段：
  
   .. csv-table::
      :widths: auto

      "字段", "描述"
      "名称", "不超过40个字符，需在应用下唯一，国际化名称为选填项"
      "标识符", "支持英文字母、数字、下划线和英文句号，4-30个字符。标识符在该应用下唯一"
      "级别", "可选择一级菜单或二级菜单"
      "上级菜单", "若菜单级别中选择了二级菜单，则需为二级菜单选择其上级菜单。"
      "排序", "决定当前菜单在其所在层级内的排序，取值为从1开始的整数，序号越小的菜单越排在上方"
      "URL", "可选字段，该菜单的URL地址，不超过2000个字符。"
      "描述", "不超过500个字符，国际化名称为选填项"

3. 点击**确认**，完成菜单的创建；

完成应用菜单创建后，可在菜单管理下查看和编辑。如下图所示：

.. image:: media/menu_management.png
   :width: 500px

### 批量授权应用菜单

在 **菜单管理** 标签页下，点击相应菜单操作栏中的 |authorize| 图标，可查看所有购买了本应用的客户，并选择需要给哪些客户授权当前菜单。如下图所示：

.. |authorize| image:: media/button_authorize_menu.png
.. image:: media/menu_authorizing_customer.png
   :width: 500px

## 管理权限

权限是指应用中独立的权限资源，例如某应用菜单对应的页面中，存在的远程启动，远程停止，远程复位3种远程操作开关。同样可以访问此页面的用户中，只有少数高权限的用户才能操作这些远程操作开关。

### 新增权限

在应用详情下进入 **权限点管理** 标签页下点击 **新建权限点**，输入权限的详细信息，包括以下字段：

.. csv-table::
   :widths: auto

   "字段", "描述"
   "名称", "不超过40个字符，名称应当在应用中唯一，国际化名称为选填项"
   "标识符", "权限标识符是用于在一个应用下唯一标识一个权限的字符串。支持英文字母、数字、下划线和英文句号，4-30个字符"
   "描述", "可选字段，不超过500个字符，国际化名称为选填项"

完成权限创建后，可在权限点管理下查看和编辑。如下图所示：

.. image:: media/permission_management.png
   :width: 500px

### 批量授权权限

一个应用可以有许多权限，购买应用的一方未必购买了所有权限。应用管理者可以指定已购买了应用的各组织能够使用该应用的哪些权限。

在 **权限点管理** 标签页下，点击相应权限操作栏中的 **客户批量授权** ，可查看所有购买了本应用的客户，并选择需要给哪些客户授权当前权限。

## 管理应用用户

当有客户通过EnOS平台申请购买应用，可以在应用详情页面处理客户的购买请求，或向客户授权应用资源权限。

1. 进入 **应用详情** 页面，点击 **审批列表** 标签。

2. 在审批列表标签页下可看到申请当前应用的客户信息。点击对应申请后的 |operation| ，可在弹出的对话框中进行审批。
  
   .. |operation| image:: media/button_customer_operation.png

3. 对于审批通过的申请记录，将会出现在该 **应用详情** 页面的 **客户管理** 标签页下，应用开发者可以在此查看并修改授权的菜单或权限。

## 购买应用

应用开发者可以通过EnOS平台购买或者出售应用，这样可促进应用的分享，减少开发类似应用的重复工作。

如需购买EnOS平台上开发的应用，可在 **应用注册** 页面，点击 **已购买** 标签 > **购买应用**。在弹窗中，输入应用的accessKey查询并发起购买申请。如需要，通过线下与应用开发者沟通达成购买协议。应用开发者可在EnOS系统中批准应用购买申请，并且分配相应资源访问权限。操作完成之后，购买的应用即出现在 **已购买** 应用列表中。

.. image:: media/purchasing_app.png
   :width: 500px

## 审批应用购买申请

应用开发者若要审批应用购买申请，可在 **应用注册** 页面中打开具体应用的 **应用详情** 页面，在 **审批列表** 标签页下可看到申请当前应用的客户信息。点击对应申请后的，可在弹出的对话框中进行审批。如下图所示：

.. image:: media/approving_purchase.png
   :width: 500px

对于审批通过的申请记录，将会出现在该应用的 **应用详情** 页面 **客户管理** 标签页下，应用开发者可以在此查看并修改授权的菜单或权限。

<!--End -->
